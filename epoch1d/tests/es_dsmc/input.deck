begin:constant
  mass_ion = 1836 * 131.3                             # electron mass multiple
  temp_ion = 0.1 * 1.16e4                             # [K]

  mass_neutral = 1836 * 131.3                             # electron mass multiple
  temp_neutral = 300                                  # [K]
  dens_neutral = 1.e20                                # [m^-3]

  temp_electron = 4. * 1.16e4                         # [K]
  dens_plasma = 1.e14                                 # [m^-3]

  part_per_species = 500000

  L = 0.05                                            # [m]
  t_sim_end = 25.e-6                                  # [s]
  t_av = 1.e-6

  v_amp = 100                                         # [V]
  E0 = v_amp * L                                      # [V/m]
  B0 = 0.01                                           # [T]  
end:constant


begin:control
  nx = 340 
  t_end = t_sim_end
  x_start = 0.0                                       # [m]
  x_end = L                                           # [m]
  
  use_random_seed = T 
  
  dt_multiplier = 0.1                                  # CLF condition multiplier
  
  es_dt_fact = 0.1
  neutral_coll_frequency_factor = 0.01
  #max_perturbation_frequency = freq
  max_b_field = B0                                    # [T]
  max_e_field = E0                                    # [V/m]
  max_speed = 2.1e6                                   # [m/s]
  norm_z_factor = 3
  #max_neutral_coll_freq = 0
end:control


begin:boundaries
  bc_x_min_particle = open
  bc_x_max_particle = open
  bc_x_min_field = open
  bc_x_max_field = open
end:boundaries


begin:fields
  bz = B0 
end:fields


begin:electrostatic
  boundary = x_max
  amp = v_amp
  t_profile = 1 #sin(omega_d*time)
end:electrostatic


begin:species
  name = electrons
  charge = -1
  mass = 1
  npart = part_per_species
  temp = temp_electron
  density = dens_plasma
end:species


begin:species
  name = ions
  charge = 1
  mass = mass_ion
  npart = part_per_species
  temp = temp_ion
  density = dens_plasma
  reinjection = electrons 
end:species

begin:background
  name = neutrals
  id = 1
  mass = mass_neutral
  density = dens_neutral
  temperature = temp_neutral
  colliding_species = electrons
  #colliding_species = ions
  density_profile = 1
  temperature_profile = 1
  t_start = 0
  t_end = t_sim_end
end:background

begin:collisions
  use_collisions = T
  collide = none
  #collide = electrons neutrals 1
  #collide = ions neutrals 1
  use_nanbu = T
  resolve_sheath = T
  #cross_section_table_location = /scratch/moe505/electrostatic-solver/epoch1d/unsteady_forcing/Xe
end:collisions


#begin:output_global
#  force_final_to_be_restartable = T
#end:output_global


begin:output
  name = normal
  
  # output snapshot
  dt_snapshot = t_av 
  
  # Number of dt_snapshot between full dumps
  #full_dump_every = 1
  dump_last = T

  # Properties at particle positions
  # px = always
  # py = always
  # pz = always
  #particle_weight = always

  # Properties on grid
  grid = always
  ex = always
  ey = never
  ez = never
  bx = never
  by = never
  bz = never
  
  potential = always
  wall_current = always
  ekbar = never + species
  charge_density = never + species
  number_density = always + species
  temperature = always + species
  neutral_collisions = always + species
  #ejected_particles = always

end:output


#begin:output
#  name = average
#  file_prefix = av
#
#  dt_average = t_av
#
#  # output start
#  time_start = 0
#
#  # output snapshot
#  dt_snapshot = t_av
#
#  # Number of dt_snapshot between full dumps
#  dump_last = F
#  dump_first = F
#
#  # Properties at particle positions
#  #px = always
#  #py = always
#  #pz = always
#  #particle_weight = always
#
#  # Properties on grid
#  grid = always
#  ex = always + average
#  #ey = never
#  #ez = never
#  #bx = never
#  #by = never
#  #bz = never
#
#  potential = always + average
#  wall_current = always + average
#  #ekbar = never + species
#  #charge_density = never + species
#  number_density = always + species + average
#  #temperature = always + species + average
#  neutral_collisions = always + species + average
#  #ejected_particles = always
#
#end:output


begin:psd_diagnostics
  show_setup = T
  sampling_period = -1. 
  averaging_time = 1. 
  #sampling_frequency =
  position_x = L * .49
  averaged_over_sampling_period = T
  number_density
  electric_potential
  electric_field
end:psd_diagnostics
